<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>dcprogs.likelihood.likelihood &#8212; HJCFIT 0.9 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="top" title="HJCFIT 0.9 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="../../../index.html">
          <span>HJCFIT 0.9 documentation</span></a></h1>
        <h2 class="heading"><span>dcprogs.likelihood.likelihood</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for dcprogs.likelihood.likelihood</h1><div class="highlight"><pre>
<span></span><span class="c1"># This file was automatically generated by SWIG (http://www.swig.org).</span>
<span class="c1"># Version 2.0.11</span>
<span class="c1">#</span>
<span class="c1"># Do not make changes to this file unless you know what you are doing--modify</span>
<span class="c1"># the SWIG interface file instead.</span>





<span class="kn">from</span> <span class="nn">sys</span> <span class="k">import</span> <span class="n">version_info</span>
<span class="k">if</span> <span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">swig_import_helper</span><span class="p">():</span>
        <span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">dirname</span>
        <span class="kn">import</span> <span class="nn">imp</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fp</span><span class="p">,</span> <span class="n">pathname</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">find_module</span><span class="p">(</span><span class="s1">&#39;_likelihood&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)])</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">_likelihood</span>
            <span class="k">return</span> <span class="n">_likelihood</span>
        <span class="k">if</span> <span class="n">fp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_mod</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="s1">&#39;_likelihood&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">pathname</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">_mod</span>
    <span class="n">_likelihood</span> <span class="o">=</span> <span class="n">swig_import_helper</span><span class="p">()</span>
    <span class="k">del</span> <span class="n">swig_import_helper</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">_likelihood</span>
<span class="k">del</span> <span class="n">version_info</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">_swig_property</span> <span class="o">=</span> <span class="nb">property</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="k">pass</span> <span class="c1"># Python &lt; 2.2 doesn&#39;t have &#39;property&#39;.</span>
<span class="k">def</span> <span class="nf">_swig_setattr_nondynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">class_type</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">static</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;thisown&quot;</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">own</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;this&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;SwigPyObject&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span>
    <span class="n">method</span> <span class="o">=</span> <span class="n">class_type</span><span class="o">.</span><span class="n">__swig_setmethods__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span><span class="p">:</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">static</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;You cannot add attributes to </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">class_type</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_swig_setattr_nondynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">class_type</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">class_type</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;thisown&quot;</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">own</span><span class="p">()</span>
    <span class="n">method</span> <span class="o">=</span> <span class="n">class_type</span><span class="o">.</span><span class="n">__swig_getmethods__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">method</span><span class="p">:</span> <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_swig_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span> <span class="n">strthis</span> <span class="o">=</span> <span class="s2">&quot;proxy of &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span> <span class="n">strthis</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&lt;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2"> &gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__module__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">strthis</span><span class="p">,)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">_object</span> <span class="o">=</span> <span class="nb">object</span>
    <span class="n">_newclass</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
    <span class="k">class</span> <span class="nc">_object</span> <span class="p">:</span> <span class="k">pass</span>
    <span class="n">_newclass</span> <span class="o">=</span> <span class="mi">0</span>



<span class="k">def</span> <span class="nf">_dcprogs_dtype</span><span class="p">():</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_dcprogs_dtype</span><span class="p">()</span>
<span class="n">_dcprogs_dtype</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_dcprogs_dtype</span>

<div class="viewcode-block" id="eig"><a class="viewcode-back" href="../../../api/python.html#dcprogs.likelihood.eig">[docs]</a><span class="k">def</span> <span class="nf">eig</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Computes eigenvalues of a matrix&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="inv"><a class="viewcode-back" href="../../../api/python.html#dcprogs.likelihood.inv">[docs]</a><span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Computes inverse of a non-singular matrix&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="det"><a class="viewcode-back" href="../../../api/python.html#dcprogs.likelihood.det">[docs]</a><span class="k">def</span> <span class="nf">det</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Computes determinant of a matrix&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">svd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">svd</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">svd</span>

<div class="viewcode-block" id="expm"><a class="viewcode-back" href="../../../api/python.html#dcprogs.likelihood.expm">[docs]</a><span class="k">def</span> <span class="nf">expm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Computes singular value decomposition of a matrix&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>
<div class="viewcode-block" id="QMatrix"><a class="viewcode-back" href="../../../api/python/qmatrix.html#dcprogs.likelihood.QMatrix">[docs]</a><span class="k">class</span> <span class="nc">QMatrix</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transition rate matrix.</span>

<span class="sd">    Open-open transitions should be located in the top-left corner.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">QMatrix</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">QMatrix</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;nopen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_nopen_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nopen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_nopen_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nopen</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_nopen_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_nopen_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_matrix_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_matrix_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_matrix_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_matrix_set</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> 
        <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_QMatrix</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix___str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix___repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<div class="viewcode-block" id="QMatrix.transpose"><a class="viewcode-back" href="../../../api/python/qmatrix.html#dcprogs.likelihood.QMatrix.transpose">[docs]</a>    <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Swaps AA block with FF, AF block with FA, nopen with nshut.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_QMatrix</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span></div>
<span class="n">QMatrix_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">QMatrix_swigregister</span>
<span class="n">QMatrix_swigregister</span><span class="p">(</span><span class="n">QMatrix</span><span class="p">)</span>

<span class="n">QMatrix</span><span class="o">.</span><span class="n">aa</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">],</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot; Open to open transitions. &quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">QMatrix</span><span class="o">.</span><span class="n">af</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">:],</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot; Open to close transitions. &quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">QMatrix</span><span class="o">.</span><span class="n">fa</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">],</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot; Open to close transitions. &quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">QMatrix</span><span class="o">.</span><span class="n">ff</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">:],</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot; Open to close transitions. &quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">QMatrix</span><span class="o">.</span><span class="n">nshut</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nopen</span><span class="p">,</span>
                         <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> \
                             <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;nopen&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">value</span><span class="p">),</span>
                         <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot; Number of shut states. &quot;&quot;&quot;</span><span class="p">);</span>

<div class="viewcode-block" id="IdealG"><a class="viewcode-back" href="../../../api/python/idealG.html#dcprogs.likelihood.IdealG">[docs]</a><span class="k">class</span> <span class="nc">IdealG</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ideal Likelihood.</span>

<span class="sd">    This object can be instantiated one of several way:</span>

<span class="sd">    - With a matrix and an integer</span>

<span class="sd">      &gt;&gt;&gt; idealg = IdealG(array([...]), 2)</span>

<span class="sd">    - With a QMatrix</span>

<span class="sd">      &gt;&gt;&gt; matrix = QMatrix(array([...]), 2)</span>
<span class="sd">      &gt;&gt;&gt; idealg = IdealG(matrix)</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IdealG</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IdealG</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> 
        <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_IdealG</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;initial_occupancies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_initial_occupancies_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">initial_occupancies</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_initial_occupancies_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;final_occupancies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_final_occupancies_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">final_occupancies</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_final_occupancies_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nopen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_nopen_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nopen</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_nopen_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nshut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_nshut_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nshut</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_nshut_get</span><span class="p">)</span>
<div class="viewcode-block" id="IdealG.af"><a class="viewcode-back" href="../../../api/python/idealG.html#dcprogs.likelihood.IdealG.af">[docs]</a>    <span class="k">def</span> <span class="nf">af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        af(self, t) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        AF transitions with respect to time</span>

<span class="sd">        Implements the ideal likelihood:</span>

<span class="sd">        .. math::</span>

<span class="sd">          e^{t\mathcal{Q}_{FF}}\mathcal{Q}_{FA}.</span>

<span class="sd">        :param t:</span>
<span class="sd">           A scalar or something to a numpy array. In the latter case, the return is an array</span>
<span class="sd">           of matrices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="IdealG.fa"><a class="viewcode-back" href="../../../api/python/idealG.html#dcprogs.likelihood.IdealG.fa">[docs]</a>    <span class="k">def</span> <span class="nf">fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fa(self, t) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        FA transitions with respect to time</span>

<span class="sd">        Implements the ideal likelihood:</span>

<span class="sd">        .. math::</span>

<span class="sd">          e^{t\mathcal{Q}_{AA}}\mathcal{Q}_{AF}.</span>

<span class="sd">        :param t:</span>
<span class="sd">           A scalar or something to a numpy array. In the latter case, the return is an array</span>
<span class="sd">           of matrices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="IdealG.laplace_af"><a class="viewcode-back" href="../../../api/python/idealG.html#dcprogs.likelihood.IdealG.laplace_af">[docs]</a>    <span class="k">def</span> <span class="nf">laplace_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        laplace_af(self, s) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        AF transitions with respect to scale</span>

<span class="sd">        Implements the laplace transform of the likelihood:</span>

<span class="sd">        .. math::</span>

<span class="sd">          (sI - \mathcal{Q}_{AA})^{-1}\mathcal{Q}_{AF}.</span>

<span class="sd">        :param s:</span>
<span class="sd">           A scalar or something to a numpy array. In the latter case, the return is an array</span>
<span class="sd">           of matrices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_laplace_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="IdealG.laplace_fa"><a class="viewcode-back" href="../../../api/python/idealG.html#dcprogs.likelihood.IdealG.laplace_fa">[docs]</a>    <span class="k">def</span> <span class="nf">laplace_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        laplace_fa(self, s) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        FA transitions with respect to scale</span>

<span class="sd">        Implements the laplace transform of the likelihood:</span>

<span class="sd">        .. math::</span>

<span class="sd">          (sI - \mathcal{Q}_{FF})^{-1}\mathcal{Q}_{FA}.</span>

<span class="sd">        :param s:</span>
<span class="sd">           A scalar or something to a numpy array. In the latter case, the return is an array</span>
<span class="sd">           of matrices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_laplace_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG___str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG___repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_IdealG</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span></div>
<span class="n">IdealG_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">IdealG_swigregister</span>
<span class="n">IdealG_swigregister</span><span class="p">(</span><span class="n">IdealG</span><span class="p">)</span>

<div class="viewcode-block" id="DeterminantEq"><a class="viewcode-back" href="../../../api/python/determinanteq.html#dcprogs.likelihood.DeterminantEq">[docs]</a><span class="k">class</span> <span class="nc">DeterminantEq</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute determinant W needed to approximate missed event G</span>

<span class="sd">    This object can be instantiated from a square matrix, the number of open states, and the</span>
<span class="sd">    resolution, or maximum length of missed events :math:`\\tau`:</span>

<span class="sd">    &gt;&gt;&gt; DeterminantEq(matrix, nopen, tau)</span>

<span class="sd">    or, it can be instantiated from a :py:class:`~dcprogs.likelihood.QMatrix` instance </span>
<span class="sd">    and :math:`\\tau`</span>

<span class="sd">    &gt;&gt;&gt; DeterminantEq(qmatrix, tau)</span>

<span class="sd">    :param matrix:</span>
<span class="sd">          Transition rate matrix, where the upper left corner contain open-open transitions</span>
<span class="sd">    :param integer nopen:</span>
<span class="sd">          Number of open states in the transition matrix.</span>
<span class="sd">    :param qmatrix:</span>
<span class="sd">          :py:class:`QMatrix` instance</span>
<span class="sd">    :param number tau:</span>
<span class="sd">          Max length of missed events.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DeterminantEq</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DeterminantEq</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> 
        <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_DeterminantEq</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>
    <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq_transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_get_tau</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq__get_tau</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_set_tau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq__set_tau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_tau</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_set_tau</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span> <span class="n">tau</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_tau</span><span class="p">,</span> <span class="n">_set_tau</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Max length of mixed events.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="DeterminantEq.__call__"><a class="viewcode-back" href="../../../api/python/determinanteq.html#dcprogs.likelihood.DeterminantEq.__call__">[docs]</a>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __call__(self, _s) -&gt; DCProgs::t_real</span>
<span class="sd">        __call__(self, _s, _tau) -&gt; DCProgs::t_real</span>
<span class="sd">        Computes the determinant of :math:`W(s)`.</span>

<span class="sd">        :param number s:</span>
<span class="sd">            The laplace scale. It can be a scalar or a numpy array of any shape.</span>
<span class="sd">            In the latter case, the return is a array of the same shape where</span>
<span class="sd">            each element is a matrix corresponding to the element in the input</span>
<span class="sd">            array.</span>
<span class="sd">        :param number tau:</span>
<span class="sd">            *Optional*. If present, it is the max length of missed events.</span>

<span class="sd">        :returns: a numpy array.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq___call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="n">__call__</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="s2">&quot;Computes determinant W</span><span class="se">\n\n</span><span class="s2">&quot;</span>                                    \
                       <span class="s2">&quot;Parameters:</span><span class="se">\n</span><span class="s2">&quot;</span>                                                 \
                       <span class="s2">&quot;  s: scalar, tuple, list, array</span><span class="se">\n</span><span class="s2">&quot;</span>                             \
                       <span class="s2">&quot;    The laplace scale.</span><span class="se">\n</span><span class="s2">&quot;</span>                                      \
                       <span class="s2">&quot;  tau: *optional* number</span><span class="se">\n</span><span class="s2">&quot;</span>                                    \
                       <span class="s2">&quot;    If present, it is the max length of missed events.</span><span class="se">\n\n</span><span class="s2">&quot;</span>    \
                       <span class="s2">&quot;Returns: If a scalar, returns a scalar. &quot;</span>                      \
                                <span class="s2">&quot;Otherwise returns a numpy array.&quot;</span>

<div class="viewcode-block" id="DeterminantEq.H"><a class="viewcode-back" href="../../../api/python/determinanteq.html#dcprogs.likelihood.DeterminantEq.H">[docs]</a>    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        H(self, s) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        H(self, s, tau) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        Computes the matrix H</span>

<span class="sd">        H is defined as  :math:`\mathcal{Q}_{AA} + \mathcal{Q}_{AF}\ \int_0^\\tau e^{-st}e^{\mathcal{Q}_{FF}t}\partial\,t\ \mathcal{Q}_{FA}`.</span>

<span class="sd">        :param number s:</span>
<span class="sd">            The laplace scale. It can be a scalar or a numpy array of any shape.</span>
<span class="sd">            In the latter case, the return is a array of the same shape where</span>
<span class="sd">            each element is a matrix corresponding to the element in the input</span>
<span class="sd">            array.</span>
<span class="sd">        :param number tau:</span>
<span class="sd">            *Optional*. If present, it is the max length of missed events.</span>

<span class="sd">        :returns: a numpy array.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq_H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="DeterminantEq.s_derivative"><a class="viewcode-back" href="../../../api/python/determinanteq.html#dcprogs.likelihood.DeterminantEq.s_derivative">[docs]</a>    <span class="k">def</span> <span class="nf">s_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        s_derivative(self, s) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        s_derivative(self, s, tau) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        Computes the derivative of H versus s</span>

<span class="sd">        H is defined as  :math:`\mathcal{Q}_{AA} + \mathcal{Q}_{AF}\ \int_0^\\tau e^{-st}e^{\mathcal{Q}_{FF}t}\partial\,t\ \mathcal{Q}_{FA}`.</span>

<span class="sd">        :param number s:</span>
<span class="sd">            The laplace scale. It can be a scalar or a numpy array of any shape.</span>
<span class="sd">            In the latter case, the return is a array of the same shape where</span>
<span class="sd">            each element is a matrix corresponding to the element in the input</span>
<span class="sd">            array.</span>
<span class="sd">        :param number tau:</span>
<span class="sd">            *Optional*. If present, it is the max length of missed events.</span>

<span class="sd">        :returns: a numpy array.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq_s_derivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq___str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq___repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_DeterminantEq</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span></div>
<span class="n">DeterminantEq_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">DeterminantEq_swigregister</span>
<span class="n">DeterminantEq_swigregister</span><span class="p">(</span><span class="n">DeterminantEq</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Asymptotes</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes asymptotic values of missed-event G.</span>

<span class="sd">    This function tkaes on input a value or an array of values in laplace space and returns the asymptotic likelihood.</span>

<span class="sd">    :param determinant:</span>
<span class="sd">       A :class:`DeterminantEq` instance from which to compute asymptotic values.</span>
<span class="sd">    :param roots:</span>
<span class="sd">       A sequence of `(root, multiplicity)` tuples.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Asymptotes</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Asymptotes</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">__repr__</span> <span class="o">=</span> <span class="n">_swig_repr</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> 
        <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_Asymptotes</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>
    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Asymptotes___call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_Asymptotes</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span>
<span class="n">Asymptotes_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Asymptotes_swigregister</span>
<span class="n">Asymptotes_swigregister</span><span class="p">(</span><span class="n">Asymptotes</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_find_lower_bound_for_roots</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_lower_bound_for_roots</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">_find_lower_bound_for_roots</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_lower_bound_for_roots</span>
<div class="viewcode-block" id="find_lower_bound_for_roots"><a class="viewcode-back" href="../../../api/python/roots.html#dcprogs.likelihood.find_lower_bound_for_roots">[docs]</a><span class="k">def</span> <span class="nf">find_lower_bound_for_roots</span><span class="p">(</span><span class="n">determinant</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="n">e0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="n">e0</span><span class="p">,</span> <span class="n">itermax</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Figures out lower bound for root.</span>

<span class="sd">       The lower bound is obtained by iteratively checking the lowest eigenvalue</span>
<span class="sd">       :math:`\\epsilon_i^s` of :math:`H(s_i)`, where :math:`s_i` is the guess at iteration</span>
<span class="sd">       :math:`i`. If the lowest eigenvalue is smaller than :math:`s_i`, then</span>
<span class="sd">       :math:`s_{i+1} = \\epsilon_i^s + \\alpha(\\epsilon_i^s - s_i)` is created.</span>

<span class="sd">       :param DeterminantEq det:</span>
<span class="sd">            Function for which to guess bound for lower root.</span>
<span class="sd">       :param Number start:</span>
<span class="sd">            Starting point. </span>
<span class="sd">       :param Number alpha: </span>
<span class="sd">            Factor from which to determine next best guess. </span>
<span class="sd">       :param Integer itermax:</span>
<span class="sd">            Maximum number of iterations before bailing out.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_lower_bound_for_roots</span><span class="p">(</span><span class="n">determinant</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">itermax</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_find_upper_bound_for_roots</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_upper_bound_for_roots</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">_find_upper_bound_for_roots</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_upper_bound_for_roots</span>
<div class="viewcode-block" id="find_upper_bound_for_roots"><a class="viewcode-back" href="../../../api/python/roots.html#dcprogs.likelihood.find_upper_bound_for_roots">[docs]</a><span class="k">def</span> <span class="nf">find_upper_bound_for_roots</span><span class="p">(</span><span class="n">determinant</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="n">e0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="n">e0</span><span class="p">,</span> <span class="n">itermax</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Figures out upper bound for root.</span>

<span class="sd">      The upper bound is obtained by iteratively checking the largest eigenvalue</span>
<span class="sd">      :math:`\\epsilon_i^s` of :math:`H(s_i)`, where :math:`s_i` is the guess at iteration</span>
<span class="sd">      :math:`i`. If the largest eigenvalue is larger than :math:`s_i`, then</span>
<span class="sd">      :math:`s_{i+1} = \\epsilon_i^s + \\alpha(\\epsilon_i^s - s_i)` is created.</span>


<span class="sd">      :param DeterminantEq det: </span>
<span class="sd">           Function for which to guess bound for lower root.</span>
<span class="sd">      :param Number start:</span>
<span class="sd">           Starting point. </span>
<span class="sd">      :param Number alpha:</span>
<span class="sd">           Factor from which to determine next best guess.</span>
<span class="sd">      :param Integer itermax:</span>
<span class="sd">           Maximum number of iterations before bailing out.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_upper_bound_for_roots</span><span class="p">(</span><span class="n">determinant</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">itermax</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_find_root_intervals</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_root_intervals</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">_find_root_intervals</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_root_intervals</span>
<div class="viewcode-block" id="find_root_intervals"><a class="viewcode-back" href="../../../api/python/roots.html#dcprogs.likelihood.find_root_intervals">[docs]</a><span class="k">def</span> <span class="nf">find_root_intervals</span><span class="p">(</span><span class="n">determinant</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">8</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Returns intervals for searching roots.</span>

<span class="sd">      Finds a set of intervals between lower_bound and upper_bound, each containing a single root.</span>

<span class="sd">      :param determinant:</span>
<span class="sd">           :class:`DeterminantEq` instance for which to guess bound for lower root.</span>
<span class="sd">      :param lower_bound: Number</span>
<span class="sd">           Lower bound of the interval within which to search for roots. If None, the lower bound</span>
<span class="sd">           is determined using :py:func:`find_lower_bound_for_roots`. </span>
<span class="sd">      :param Number upper_bound:</span>
<span class="sd">           Upper bound of the interval within which to search for roots. If None, the upper bound</span>
<span class="sd">           is determined using :py:func:`find_upper_bound_for_roots`. </span>
<span class="sd">      :param Number tolerance:</span>
<span class="sd">           Size of the smallest possible intervals. Intervals smaller than this are likely to</span>
<span class="sd">           have multiple roots.</span>
<span class="sd">      :raises: ArithmeticError when NaN is encountered or when eigenvalue solver fails.</span>
<span class="sd">      :returns:</span>
<span class="sd">           A list `[(a, b), multiplicity]`, where `(a, b)` denotes an interval, and</span>
<span class="sd">           `multiplicity` the multiplicity of the root. All roots with `multiplicity`:math:`&gt; 1`</span>
<span class="sd">           will have a size of `tolerance` or smaller.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">NaN</span>
  <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">NaN</span>
  <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">NaN</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_root_intervals</span><span class="p">(</span><span class="n">determinant</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_find_root_intervals_brute_force</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_root_intervals_brute_force</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">_find_root_intervals_brute_force</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_root_intervals_brute_force</span>
<div class="viewcode-block" id="find_root_intervals_brute_force"><a class="viewcode-back" href="../../../api/python/roots.html#dcprogs.likelihood.find_root_intervals_brute_force">[docs]</a><span class="k">def</span> <span class="nf">find_root_intervals_brute_force</span><span class="p">(</span> <span class="n">determinant</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">tolerance</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">8</span> <span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Find intervals for roots using brute force.</span>

<span class="sd">      Computes all values between lower_bound and upper_bound, for a given resolution. If the</span>
<span class="sd">      determinant changes sign between two values, or if it comes to within tolerance of zero,</span>
<span class="sd">      then the eigenvalues of H are used to determine possible multiplicity.</span>

<span class="sd">      :param determinant:</span>
<span class="sd">           Instance of :py:class:`DeterminantEq` for which to find root intervals</span>
<span class="sd">      :param Number resolution:</span>
<span class="sd">           Resolution at which to sample interval.</span>
<span class="sd">      :param Number lower_bound: </span>
<span class="sd">           Lower bound of interval. If None, then :py:func:`find_lower_bound_for_roots` is called.</span>
<span class="sd">      :param Number upper_bound:</span>
<span class="sd">           Upper bound of interval. If None, then :py:func:`find_upper_bound_for_roots` is called.</span>
<span class="sd">      :param Number tolerance:</span>
<span class="sd">           Tolerance below which the value of the determinant is considered *close* *to* *zero*.</span>

<span class="sd">      :raises: ArithmeticError when NaN is encountered or when eigenvalue solver fails.\n\n&quot;</span>

<span class="sd">      :returns:</span>
<span class="sd">         A list `[(a, b), multiplicity]`, where `(a, b)` denotes an interval, and `multiplicity`</span>
<span class="sd">         the multiplicity of the root. All roots with `multiplicity &gt; 1` will have a size of</span>
<span class="sd">         `tolerance` or smaller.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">NaN</span>
  <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">NaN</span>
  <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">NaN</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_find_root_intervals_brute_force</span><span class="p">(</span>
           <span class="n">determinant</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExactSurvivor"><a class="viewcode-back" href="../../../api/python/exact_survivor.html#dcprogs.likelihood.ExactSurvivor">[docs]</a><span class="k">class</span> <span class="nc">ExactSurvivor</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes exact missed-event survivor function.</span>

<span class="sd">    :param qmatrix:</span>
<span class="sd">       The Q-matrix for which to compute the exact likelihood. </span>
<span class="sd">    :param float double:</span>
<span class="sd">       The maximum length of missed events.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ExactSurvivor</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ExactSurvivor</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> 
        <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_ExactSurvivor</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>
<div class="viewcode-block" id="ExactSurvivor.af"><a class="viewcode-back" href="../../../api/python/exact_survivor.html#dcprogs.likelihood.ExactSurvivor.af">[docs]</a>    <span class="k">def</span> <span class="nf">af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open to close transitions</span>
<span class="sd">        Open to close transitions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExactSurvivor.fa"><a class="viewcode-back" href="../../../api/python/exact_survivor.html#dcprogs.likelihood.ExactSurvivor.fa">[docs]</a>    <span class="k">def</span> <span class="nf">fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closed to open transitions</span>
<span class="sd">        Closed to open transitions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExactSurvivor.recursion_af"><a class="viewcode-back" href="../../../api/python/exact_survivor.html#dcprogs.likelihood.ExactSurvivor.recursion_af">[docs]</a>    <span class="k">def</span> <span class="nf">recursion_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:math:`C_{iml}` recursion matrices for af.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_recursion_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExactSurvivor.recursion_fa"><a class="viewcode-back" href="../../../api/python/exact_survivor.html#dcprogs.likelihood.ExactSurvivor.recursion_fa">[docs]</a>    <span class="k">def</span> <span class="nf">recursion_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:math:`C_{iml}` recursion matrices for fa.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_recursion_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExactSurvivor.D_af"><a class="viewcode-back" href="../../../api/python/exact_survivor.html#dcprogs.likelihood.ExactSurvivor.D_af">[docs]</a>    <span class="k">def</span> <span class="nf">D_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:math:`D_i` matrices for af.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_D_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExactSurvivor.D_fa"><a class="viewcode-back" href="../../../api/python/exact_survivor.html#dcprogs.likelihood.ExactSurvivor.D_fa">[docs]</a>    <span class="k">def</span> <span class="nf">D_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:math:`D_i` matrices for fa.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_D_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_tau_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">tau</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_tau_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;eigenvalues_af&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_eigenvalues_af_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">eigenvalues_af</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_eigenvalues_af_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;eigenvalues_fa&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_eigenvalues_fa_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">eigenvalues_fa</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_eigenvalues_fa_get</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor___str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor___repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_ExactSurvivor</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span></div>
<span class="n">ExactSurvivor_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ExactSurvivor_swigregister</span>
<span class="n">ExactSurvivor_swigregister</span><span class="p">(</span><span class="n">ExactSurvivor</span><span class="p">)</span>

<div class="viewcode-block" id="ApproxSurvivor"><a class="viewcode-back" href="../../../api/python/approx_survivor.html#dcprogs.likelihood.ApproxSurvivor">[docs]</a><span class="k">class</span> <span class="nc">ApproxSurvivor</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes approximate missed-event survivor function.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ApproxSurvivor</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ApproxSurvivor</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Initializes the approximate survivor function.</span>

<span class="sd">          There are three possible ways to instantiate this object:</span>

<span class="sd">          &gt;&gt;&gt; ApproxSurvivor(determinant_af, roots_af, determinant_fa, roots_fa)</span>
<span class="sd">          &gt;&gt;&gt; ApproxSurvivor(matrix, nopen, tau, **kwargs)</span>
<span class="sd">          &gt;&gt;&gt; ApproxSurvivor(qmatrix, tau, **kwargs)</span>

<span class="sd">          The parameters between brackets are optional. The last two versions will try and calculate</span>
<span class="sd">          the roots of the determinant equations automatically. A number of parameters can be given</span>
<span class="sd">          to control this process. The keyword arguments are listed below.</span>

<span class="sd">          :param determinant_af:</span>
<span class="sd">              A :class:`DeterminantEq` instance, specifically for the af block.</span>
<span class="sd">          :param roots_af:</span>
<span class="sd">             The roots of the af determinant equation. The should come in the format</span>
<span class="sd">             `[(root, multiplicity), (root, multiplicity), ...]`.</span>
<span class="sd">          :param determinant_fa:</span>
<span class="sd">             A :class:`DeterminantEq` instance, specifically for the fa block.</span>
<span class="sd">             It should the transpose of `determinant_af`. It is required so </span>
<span class="sd">             it need not be recomputed, since it most likely already exists.</span>
<span class="sd">          :param roots_fa:</span>
<span class="sd">             The roots of the fa determinant equation. The should come in the format </span>
<span class="sd">             `[(root, multiplicity), (root, multiplicity), ...]`.</span>
<span class="sd">          :param matrix:</span>
<span class="sd">             An object convertible to a square matrix.</span>
<span class="sd">          :param integer nopen:</span>
<span class="sd">             Number of open states.</span>
<span class="sd">          :param qmatrix:</span>
<span class="sd">             A :class:`QMatrix` instance.</span>
<span class="sd">          :param float xtol: </span>
<span class="sd">             Tolerance criteria when computing roots using :func:`~dcprogs.likelihood.brentq`.</span>
<span class="sd">             Defaults to 1e-12.</span>
<span class="sd">          :param float rtol:</span>
<span class="sd">             Tolerance criteria when computing roots using :func:`~dcprogs.likelihood.brentq`.</span>
<span class="sd">             Defaults to 1e-12.</span>
<span class="sd">          :param float itermax:</span>
<span class="sd">             Maximum number of iterations when computing roots using</span>
<span class="sd">             :func:`~dcprogs.likelihood.brentq`.</span>
<span class="sd">             Defaults to 100.</span>
<span class="sd">          :param float lower_bound:</span>
<span class="sd">             Lower bound for *all* roots. Defaults to None, in which the case the lower bound is</span>
<span class="sd">             computed from :py:func:`find_lower_bound_for_roots`.</span>
<span class="sd">          :param float upper_bound:</span>
<span class="sd">             Upper bound for *all* roots. Defaults to None, in which the case the upper bound is</span>
<span class="sd">             computed from :py:func:`find_upper_bound_for_roots`.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">NaN</span><span class="p">,</span> <span class="n">array</span>
      <span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">internal_dtype</span>
      <span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">QMatrix</span>
      <span class="c1"># Try first initalization mode</span>
      <span class="n">det_af</span>   <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;det_af&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">det_af</span><span class="p">,</span> <span class="n">DeterminantEq</span><span class="p">):</span>
        <span class="n">roots_af</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;roots_af&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">roots_af</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Missing roots_af argument&#39;</span><span class="p">)</span>
        <span class="n">det_fa</span>   <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;det_fa&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">det_fa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Missing det_fa argument&#39;</span><span class="p">)</span>
        <span class="n">roots_fa</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;roots_fa&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">roots_fa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Missing roots_fa argument&#39;</span><span class="p">)</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_ApproxSurvivor</span><span class="p">(</span><span class="n">det_af</span><span class="p">,</span> <span class="n">roots_af</span><span class="p">,</span> <span class="n">det_fa</span><span class="p">,</span> <span class="n">roots_fa</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>
        <span class="k">return</span>

      <span class="c1"># Try second and third instanciation</span>
      <span class="n">matrix</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qmatrix&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Expected the q-matrix or a matrix + number of open states on input.&quot;</span><span class="p">)</span>
      <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">QMatrix</span><span class="p">):</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">internal_dtype</span><span class="p">)</span>
        <span class="n">nopen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nopen&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nopen</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
          <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;A matrix was given on input, but without a nopen parameter.&quot;</span><span class="p">)</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">QMatrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">nopen</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

      <span class="n">tau</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">tau</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;No tau given on input.&quot;</span><span class="p">)</span>
      <span class="n">xtol</span>        <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xtol&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
      <span class="n">rtol</span>        <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">2</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rtol&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
      <span class="n">itermax</span>     <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">3</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itermax&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
      <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">4</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lower_bound&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">5</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;upper_bound&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">NaN</span>
      <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">NaN</span>
      
      <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_ApproxSurvivor</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">xtol</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">itermax</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
      <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>


<div class="viewcode-block" id="ApproxSurvivor.af"><a class="viewcode-back" href="../../../api/python/approx_survivor.html#dcprogs.likelihood.ApproxSurvivor.af">[docs]</a>    <span class="k">def</span> <span class="nf">af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open to close transitions</span>
<span class="sd">        Open to close transitions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApproxSurvivor.fa"><a class="viewcode-back" href="../../../api/python/approx_survivor.html#dcprogs.likelihood.ApproxSurvivor.fa">[docs]</a>    <span class="k">def</span> <span class="nf">fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closed to open transitions</span>
<span class="sd">        Closed to open transitions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;af_components&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor_af_components_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">af_components</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor_af_components_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;fa_components&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor_fa_components_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">fa_components</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor_fa_components_get</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor___str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor___repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_ApproxSurvivor</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span></div>
<span class="n">ApproxSurvivor_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">ApproxSurvivor_swigregister</span>
<span class="n">ApproxSurvivor_swigregister</span><span class="p">(</span><span class="n">ApproxSurvivor</span><span class="p">)</span>

<div class="viewcode-block" id="MissedEventsG"><a class="viewcode-back" href="../../../api/python/missed_eventsG.html#dcprogs.likelihood.MissedEventsG">[docs]</a><span class="k">class</span> <span class="nc">MissedEventsG</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes missed-events likelihood.</span>

<span class="sd">    Exact calculations take place for times smaller than :math:`n_{\mathrm{max}}\\tau`. Asymptotic calculations take over for larger times.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MissedEventsG</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MissedEventsG</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Initializes the missed-events likelihood. </span>

<span class="sd">          Exact calculations take place for times smaller than `nmax * tau`.</span>
<span class="sd">          Asymptotic calculations take over for larger times.</span>

<span class="sd">          There are three possible ways to instantiate this object:</span>

<span class="sd">          &gt;&gt;&gt; MissedEvents(determinant_af, roots_af, determinant_fa, roots_fa[, nmax=2])</span>
<span class="sd">          &gt;&gt;&gt; MissedEvents(matrix, nopen, tau, **kwargs)</span>
<span class="sd">          &gt;&gt;&gt; MissedEvents(qmatrix, tau, **kwargs)</span>

<span class="sd">          The parameters between brackets are optional. The last two versions will try </span>
<span class="sd">          and calculate the roots of the determinant equations automatically. A number of parameters</span>
<span class="sd">          can be given to control this process.</span>

<span class="sd">          :param determinant_af:</span>
<span class="sd">              A :class:`DeterminantEq` instance, specifically for the af block.</span>
<span class="sd">          :param roots_af:</span>
<span class="sd">             The roots of the af determinant equation. The should come in the format</span>
<span class="sd">             `[(root, multiplicity), (root, multiplicity), ...]`.</span>
<span class="sd">          :param determinant_fa:</span>
<span class="sd">             A :class:`DeterminantEq` instance, specifically for the fa block.</span>
<span class="sd">             It should the transpose of `determinant_af`. It is required so </span>
<span class="sd">             it need not be recomputed, since it most likely already exists.</span>
<span class="sd">          :param roots_fa:</span>
<span class="sd">             The roots of the fa determinant equation. The should come in the format </span>
<span class="sd">             `[(root, multiplicity), (root, multiplicity), ...]`.</span>
<span class="sd">          :param matrix:</span>
<span class="sd">             An object convertible to a square matrix.</span>
<span class="sd">          :param integer nopen:</span>
<span class="sd">             Number of open states.</span>
<span class="sd">          :param qmatrix:</span>
<span class="sd">             A :class:`QMatrix` instance.</span>
<span class="sd">          :param int nmax: </span>
<span class="sd">             The exact missed event likelihood will be computed for times </span>
<span class="sd">             :math:`t \in [0, n_{\mathrm{max}} \tau`. Defaults to 3.</span>
<span class="sd">          :param float xtol: </span>
<span class="sd">             Tolerance criteria when computing roots using :func:`~dcprogs.likelihood.brentq`.</span>
<span class="sd">             Defaults to 1e-12.</span>
<span class="sd">          :param float rtol:</span>
<span class="sd">             Tolerance criteria when computing roots using :func:`~dcprogs.likelihood.brentq`.</span>
<span class="sd">             Defaults to 1e-12.</span>
<span class="sd">          :param float itermax:</span>
<span class="sd">             Maximum number of iterations when computing roots using</span>
<span class="sd">             :func:`~dcprogs.likelihood.brentq`.</span>
<span class="sd">             Defaults to 100.</span>
<span class="sd">          :param float lower_bound:</span>
<span class="sd">             Lower bound for *all* roots. Defaults to None, in which the case the lower bound is</span>
<span class="sd">             computed from :py:func:`find_lower_bound_for_roots`.</span>
<span class="sd">          :param float upper_bound:</span>
<span class="sd">             Upper bound for *all* roots. Defaults to None, in which the case the upper bound is</span>
<span class="sd">             computed from :py:func:`find_upper_bound_for_roots`.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">NaN</span><span class="p">,</span> <span class="n">array</span>
      <span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">internal_dtype</span>
      <span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">QMatrix</span>
      <span class="c1"># Try first initalization mode</span>
      <span class="n">det_af</span>   <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;det_af&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">det_af</span><span class="p">,</span> <span class="n">DeterminantEq</span><span class="p">):</span>
        <span class="n">roots_af</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;roots_af&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">roots_af</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Missing roots_af argument&#39;</span><span class="p">)</span>
        <span class="n">det_fa</span>   <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;det_fa&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">det_fa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Missing det_fa argument&#39;</span><span class="p">)</span>
        <span class="n">roots_fa</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;roots_fa&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">roots_fa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Missing roots_fa argument&#39;</span><span class="p">)</span>
        <span class="n">nmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nmax&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_MissedEventsG</span><span class="p">(</span><span class="n">det_af</span><span class="p">,</span> <span class="n">roots_af</span><span class="p">,</span> <span class="n">det_fa</span><span class="p">,</span> <span class="n">roots_fa</span><span class="p">,</span> <span class="n">nmax</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>
        <span class="k">return</span>

      <span class="c1"># Try second and third instanciation</span>
      <span class="n">matrix</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qmatrix&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
      <span class="k">if</span> <span class="n">matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected the q-matrix or a matrix + number of open states on input.&quot;</span><span class="p">)</span>
      <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">QMatrix</span><span class="p">):</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">internal_dtype</span><span class="p">)</span>
        <span class="n">nopen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nopen&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nopen</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
          <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A matrix was given on input, but without a nopen parameter.&quot;</span><span class="p">)</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">QMatrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">nopen</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

      <span class="n">tau</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">tau</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No tau given on input.&quot;</span><span class="p">)</span>
      <span class="n">nmax</span>        <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nmax&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
      <span class="n">xtol</span>        <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">2</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xtol&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
      <span class="n">rtol</span>        <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">3</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rtol&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span>
      <span class="n">itermax</span>     <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">4</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;itermax&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
      <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">5</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lower_bound&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">index</span><span class="o">+</span><span class="mi">6</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;upper_bound&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">NaN</span>
      <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">NaN</span>
      
      <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_MissedEventsG</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">xtol</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">itermax</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
      <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>


<div class="viewcode-block" id="MissedEventsG.af"><a class="viewcode-back" href="../../../api/python/missed_eventsG.html#dcprogs.likelihood.MissedEventsG.af">[docs]</a>    <span class="k">def</span> <span class="nf">af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        af(self, t) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        Likelihood of an observed open time of length ``t``</span>

<span class="sd">        :param t:</span>
<span class="sd">           A scalar or something to a numpy array. In the latter case, the return is an array</span>
<span class="sd">           of matrices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="MissedEventsG.fa"><a class="viewcode-back" href="../../../api/python/missed_eventsG.html#dcprogs.likelihood.MissedEventsG.fa">[docs]</a>    <span class="k">def</span> <span class="nf">fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fa(self, t) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        Likelihood of a shut time of length ``t``</span>

<span class="sd">        :param t:</span>
<span class="sd">           A scalar or something to a numpy array. In the latter case, the return is an array</span>
<span class="sd">           of matrices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="MissedEventsG.laplace_af"><a class="viewcode-back" href="../../../api/python/missed_eventsG.html#dcprogs.likelihood.MissedEventsG.laplace_af">[docs]</a>    <span class="k">def</span> <span class="nf">laplace_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        laplace_af(self, s) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        Exact missed-events G in Laplace space.</span>

<span class="sd">        The exact expression is :math:`^{e}\mathcal{G}_{AF}(s) = {}^AR(s) e^{-s\\tau}\mathcal{Q}_{AF}e^{\mathcal{Q}_{FF}\\tau}`, with :math:`{}^AR(s) = [sI - \mathcal{Q}_{AA} - \mathcal{Q}_{AF} \\int_0^\\tau e^{-st}e^{\mathcal{Q}_{FF}t}\\partial t \mathcal{Q}_{FA}]^{-1}`.</span>

<span class="sd">        :param s:</span>
<span class="sd">          The laplace scale. A real scalar or something convertible to a numpy array.</span>

<span class="sd">        :returns:</span>
<span class="sd">          A matrix if the input is scalar, an array of matrices otherwise, </span>
<span class="sd">          with the shape of the input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_laplace_af</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="MissedEventsG.laplace_fa"><a class="viewcode-back" href="../../../api/python/missed_eventsG.html#dcprogs.likelihood.MissedEventsG.laplace_fa">[docs]</a>    <span class="k">def</span> <span class="nf">laplace_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        laplace_fa(self, s) -&gt; DCProgs::t_rmatrix</span>
<span class="sd">        Exact missed-events G in Laplace space.</span>

<span class="sd">        The exact expression is :math:`^{e}\mathcal{G}_{FA}(s) = {}^FR(s) e^{-s\\tau}\mathcal{Q}_{FA}e^{\mathcal{Q}_{AA}\\tau}`, with :math:`{}^FR(s) = [sI - \mathcal{Q}_{FF} - \mathcal{Q}_{FA} \\int_0^\\tau e^{-st}e^{\mathcal{Q}_{AA}t}\\partial t \mathcal{Q}_{AF}]^{-1}`.</span>

<span class="sd">        :param s:</span>
<span class="sd">          The laplace scale. A real scalar or something convertible to a numpy array.</span>

<span class="sd">        :returns:</span>
<span class="sd">          A matrix if the input is scalar, an array of matrices otherwise, </span>
<span class="sd">          with the shape of the input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_laplace_fa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="MissedEventsG.initial_CHS_occupancies"><a class="viewcode-back" href="../../../api/python/missed_eventsG.html#dcprogs.likelihood.MissedEventsG.initial_CHS_occupancies">[docs]</a>    <span class="k">def</span> <span class="nf">initial_CHS_occupancies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes initial CHS occupancies.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_initial_CHS_occupancies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="MissedEventsG.final_CHS_occupancies"><a class="viewcode-back" href="../../../api/python/missed_eventsG.html#dcprogs.likelihood.MissedEventsG.final_CHS_occupancies">[docs]</a>    <span class="k">def</span> <span class="nf">final_CHS_occupancies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes final CHS occupancies.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_final_CHS_occupancies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_tau_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">tau</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_tau_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;af_factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_af_factor_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">af_factor</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_af_factor_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;fa_factor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_fa_factor_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">fa_factor</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_fa_factor_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;initial_occupancies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_initial_occupancies_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">initial_occupancies</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_initial_occupancies_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;final_occupancies&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_final_occupancies_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">final_occupancies</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_final_occupancies_get</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG___str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG___repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;tmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_tmax_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">tmax</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_tmax_get</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;nmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nmax_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nmax_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nmax</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nmax_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nmax_set</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nopen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nopen_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nopen</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nopen_get</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nshut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nshut_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nshut</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_nshut_get</span><span class="p">)</span>
    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_MissedEventsG</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span></div>
<span class="n">MissedEventsG_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">MissedEventsG_swigregister</span>
<span class="n">MissedEventsG_swigregister</span><span class="p">(</span><span class="n">MissedEventsG</span><span class="p">)</span>

<div class="viewcode-block" id="Log10Likelihood"><a class="viewcode-back" href="../../../api/python/log10likelihood.html#dcprogs.likelihood.Log10Likelihood">[docs]</a><span class="k">class</span> <span class="nc">Log10Likelihood</span><span class="p">(</span><span class="n">_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a functor for optimizing the likelihood.</span>

<span class="sd">    This functor can as input a :math:`\mathcal{Q}`-matrix and returns the resulting</span>
<span class="sd">    likelihood. The root finding process is performed by :py:func:`find_roots`. Most of the</span>
<span class="sd">    arguments to initialize this functor are parameters for that process.</span>

<span class="sd">    .. attribute:: nopen</span>

<span class="sd">       Number of open states. Should be strictly positive.</span>

<span class="sd">    .. attribute:: tau</span>

<span class="sd">       Maximum length of missed events. Should be positive.</span>

<span class="sd">    .. attribute:: tcritical</span>

<span class="sd">       :math:`t_{\mathrm{crit}}` for CHS vectors. If negative, ``None``, or ``NaN``, </span>
<span class="sd">       then the initial and final states are the equilibrium occupancies.</span>

<span class="sd">    .. attribute:: nmax</span>

<span class="sd">      The exact missed-events likelihood will be computed for </span>
<span class="sd">      :math:`t &lt; n_{\mathrm{max}}	au`.</span>

<span class="sd">    .. attribute:: xtol </span>

<span class="sd">       Tolerance criteria when computing roots via :py:func:`likelihood.brentq`.</span>

<span class="sd">    .. attribute:: rtol</span>

<span class="sd">       Tolerance criteria when computing roots via :py:func:`likelihood.brentq`.</span>

<span class="sd">    .. attribute:: itermax</span>

<span class="sd">       Maximum number of iterations when computing roots via :py:func:`likelihood.brentq`.</span>
<span class="sd">    .. attribute:: lower_bound</span>

<span class="sd">       Lower bound bracketing all roots. If None or NaN, then the lower bound will be </span>
<span class="sd">       computed during calls by :py:func:`~dcprogs.likelihood.find_lower_bound_for_root`</span>

<span class="sd">    .. attribute:: upper_bound</span>

<span class="sd">       Upper bound bracketing all roots. If None or NaN, then the upper bound will be </span>
<span class="sd">       computed during calls by :py:func:`~dcprogs.likelihood.find_upper_bound_for_root`</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__swig_setmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__setattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">_swig_setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Log10Likelihood</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">__swig_getmethods__</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">__getattr__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">_swig_getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Log10Likelihood</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;nopen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nopen_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nopen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nopen_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nopen</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nopen_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nopen_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tau_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tau_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">tau</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tau_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tau_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;tcritical&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tcritical_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;tcritical&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tcritical_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">tcritical</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tcritical_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_tcritical_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;nmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nmax_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;nmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nmax_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">nmax</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nmax_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_nmax_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;xtol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_xtol_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;xtol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_xtol_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">xtol</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_xtol_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_xtol_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_rtol_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;rtol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_rtol_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">rtol</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_rtol_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_rtol_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;itermax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_itermax_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;itermax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_itermax_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">itermax</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_itermax_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_itermax_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;lower_bound&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_lower_bound_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;lower_bound&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_lower_bound_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_lower_bound_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_lower_bound_set</span><span class="p">)</span>
    <span class="n">__swig_setmethods__</span><span class="p">[</span><span class="s2">&quot;upper_bound&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_upper_bound_set</span>
    <span class="n">__swig_getmethods__</span><span class="p">[</span><span class="s2">&quot;upper_bound&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_upper_bound_get</span>
    <span class="k">if</span> <span class="n">_newclass</span><span class="p">:</span><span class="n">upper_bound</span> <span class="o">=</span> <span class="n">_swig_property</span><span class="p">(</span><span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_upper_bound_get</span><span class="p">,</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_upper_bound_set</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">bursts</span><span class="p">,</span> <span class="n">nopen</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">tcritical</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span>
                  <span class="n">itermax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Initializes the missed-events likelihood. </span>

<span class="sd">          :param bursts:</span>
<span class="sd">             A sequence of bursts. Each burst is a sequence of open and shut intervals. </span>
<span class="sd">             There should always be an odd number of intervals. And the first interval </span>
<span class="sd">             is open by default.</span>
<span class="sd">          :param integer nopen:</span>
<span class="sd">             Number of open states. Should be strictly positive.</span>
<span class="sd">          :param float tau:</span>
<span class="sd">             Maximum length of missed events. Should be positive.</span>
<span class="sd">          :param float tcritical:</span>
<span class="sd">             :math:`t_{\mathrm{crit}}` for CHS vectors. If None, then the initial and final states</span>
<span class="sd">             are the equilibrium occupancies.</span>
<span class="sd">          :param integer nmax:</span>
<span class="sd">             The exact missed-events likelihood will be computed for </span>
<span class="sd">             :math:`t &lt; n_{\matrm{max}}\tau`.</span>
<span class="sd">          :param float xtol:</span>
<span class="sd">             Tolerance criteria when computing roots via :meth:`likelihood.brentq`</span>
<span class="sd">          :param float rtol:</span>
<span class="sd">             Tolerance criteria when computing roots via :meth:`likelihood.brentq`.</span>
<span class="sd">          :param interger itermax:</span>
<span class="sd">             Maximum number of iterations when computing roots via :meth:`likelihood.brentq`.</span>
<span class="sd">          :param float lower_bound:</span>
<span class="sd">             Lower bound for *all* roots. Defaults to None, in which the case the lower bound is</span>
<span class="sd">             computed from :py:func:`find_lower_bound_for_roots`.</span>
<span class="sd">          :param float upper_bound:</span>
<span class="sd">             Upper bound for *all* roots. Defaults to None, in which the case the upper bound is</span>
<span class="sd">             computed from :py:func:`find_upper_bound_for_roots`.</span>
<span class="sd">      &quot;&quot;&quot;</span>
      <span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">NaN</span>
      <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">NaN</span>
      <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">NaN</span>
      <span class="k">if</span> <span class="n">tcritical</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">tcritical</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="n">e0</span>
      
      <span class="n">this</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">new_Log10Likelihood</span><span class="p">(</span> <span class="n">bursts</span><span class="p">,</span> <span class="n">nopen</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">tcritical</span><span class="p">,</span> <span class="n">nmax</span><span class="p">,</span> <span class="n">xtol</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">itermax</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span>
                      <span class="n">upper_bound</span> <span class="p">)</span>
      <span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
      <span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">this</span> <span class="o">=</span> <span class="n">this</span>


    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the nth burst.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood___getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Log10Likelihood.insert"><a class="viewcode-back" href="../../../api/python/log10likelihood.html#dcprogs.likelihood.Log10Likelihood.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inserts a burst at given index.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the nth burst.</span>

<span class="sd">        :param index:</span>
<span class="sd">           Index to the burst that should be changed.</span>
<span class="sd">        :param value:</span>
<span class="sd">           A list of time intervals with an odd number of components, in seconds.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood___setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the nth burst.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood___delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of bursts.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood___len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood___str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood___repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<div class="viewcode-block" id="Log10Likelihood.vector"><a class="viewcode-back" href="../../../api/python/log10likelihood.html#dcprogs.likelihood.Log10Likelihood.vector">[docs]</a>    <span class="k">def</span> <span class="nf">vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        vector(self, _Q) -&gt; DCProgs::t_rvector</span>
<span class="sd">        Computes the :math:`log_{10}`-likelihood for each individual burst</span>

<span class="sd">        The sum over the return of this function is the return of :py:meth:`__call__`.</span>
<span class="sd">        This is merely a convenience function if one wants the likelihood associate with</span>
<span class="sd">        each burst</span>

<span class="sd">        :param matrix:</span>
<span class="sd">           Can be either a square numpy array  or a :py:class:`QMatrix` object. In the first</span>
<span class="sd">           case, the number of open states is set to attribute `nopen`.</span>

<span class="sd">        :return:</span>

<span class="sd">           A numpy array where each component contains the :math:`log_{10}` likelihood of a</span>
<span class="sd">           single burst.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="Log10Likelihood.__call__"><a class="viewcode-back" href="../../../api/python/log10likelihood.html#dcprogs.likelihood.Log10Likelihood.__call__">[docs]</a>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __call__(self, _Q) -&gt; DCProgs::t_real</span>
<span class="sd">        Computes the :math:`log_{10}`-likelihood for the input Q-matrix</span>

<span class="sd">        :param matrix:</span>
<span class="sd">           Can be either a square numpy array  or a :py:class:`QMatrix` object. In the first</span>
<span class="sd">           case, the number of open states is set to attribute `nopen`.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood___call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

    <span class="n">__swig_destroy__</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">delete_Log10Likelihood</span>
    <span class="n">__del__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span> <span class="p">:</span> <span class="kc">None</span><span class="p">;</span></div>
<span class="n">Log10Likelihood_swigregister</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">Log10Likelihood_swigregister</span>
<span class="n">Log10Likelihood_swigregister</span><span class="p">(</span><span class="n">Log10Likelihood</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_brentq</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_brentq</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">_brentq</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_brentq</span>
<div class="viewcode-block" id="brentq"><a class="viewcode-back" href="../../../api/python/roots.html#dcprogs.likelihood.brentq">[docs]</a><span class="k">def</span> <span class="nf">brentq</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">4.440892098e-16</span><span class="p">,</span> <span class="n">itermax</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Computes zeros via brentq.</span>
<span class="sd">       </span>
<span class="sd">      This is the exact same algorithm as scipy.optimize.brentq. Only, the errors and c types</span>
<span class="sd">      have been changed to accomodate DCProgs and protect the innocents.</span>

<span class="sd">      :param callable function:</span>
<span class="sd">         Function for which to solve :math:`f(x) = 0`.</span>
<span class="sd">      :param float xstart:</span>
<span class="sd">         Beginning of the interval</span>
<span class="sd">      :param float xend:</span>
<span class="sd">         End of the interval</span>
<span class="sd">      :param float xtol: </span>
<span class="sd">         Tolerance for interval size. </span>
<span class="sd">      :param float rtol: </span>
<span class="sd">         Tolerance for interval size. The convergence criteria is an affine function of the</span>
<span class="sd">         root:</span>
<span class="sd">         :math:`x_{\\mathrm{tol}}+r_{\\mathrm{tol}} x_{\\mathrm{current}} = \\frac{|x_a-x_b|}{2}`.</span>
<span class="sd">      :param int itermax: </span>
<span class="sd">         maximum number of iterations.</span>

<span class="sd">      :returns: the tuple (x, iterations, times the function was called)</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">xtol</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;xtol must be strictly positive&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="n">rtol</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;rtol must be strictly positive&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="n">itermax</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;itermax must be strictly positive&quot;</span><span class="p">);</span>
  <span class="k">if</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Interval is not valid: </span><span class="si">{0}</span><span class="s2"> &gt;= </span><span class="si">{1}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">_brentq</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xtol</span><span class="p">,</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">itermax</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">time_filter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters out time series for intervals smaller that :math:`\tau`</span>

<span class="sd">    This procedure erases small intervals from the time series.</span>

<span class="sd">    :param times:</span>
<span class="sd">       A timer series to filter. It can also arrays of time series. In that case, The filters are applied independently to all but the innermost sequence.</span>

<span class="sd">    :returns: A numpy array, or a list of numpy arrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">time_filter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">interval_filter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filters out  intervals smaller that :math:`\tau`</span>

<span class="sd">    This procedure erases small intervals from the time series that can be created from the input. </span>

<span class="sd">    :param times:</span>
<span class="sd">       A timer series to filter. It can also arrays of time series. In that case, The filters are applied independently to all but the innermost sequence.</span>

<span class="sd">    :returns: A numpy array, or a list of numpy arrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">interval_filter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">chained_likelihood</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">chained_likelihood</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="n">chained_likelihood</span> <span class="o">=</span> <span class="n">_likelihood</span><span class="o">.</span><span class="n">chained_likelihood</span>
<span class="c1"># This file is compatible with both classic and new-style classes.</span>


</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2016, University College London.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>